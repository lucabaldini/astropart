%
% Last reviewed on February 25, 2026
%

\chapter{Motion in a magnetic field}\label{chap:bmotion}

In this chapter we briefly revise some basic facts about the motion of a charged
particle in a magnetic field. This is relevant for several different topics that are
covered in this book, including the rigidity measurement in a magnetic spectrometer
(section~\ref{sec:cr_exp_techniques}), the geomagnetically trapped radiation
(section~\ref{sec:geomagnetic_field}) and the stochastic acceleration of cosmic rays
(section~\ref{sec:cr_acceleration}), in both the second-order and first-order
settings.

The equation of motion in a (purely) magnetic field is of a particle with charge
$q$ is dictated by the expression of the Lorentz force\sidenote{Since the
Lorentz force is orthogonal to the velocity, classically it does not do work, that,
is, it does not change the magnitude of $\vb{v}$, nor the relativistic $\gamma$
factor
\begin{align*}
  \dv{\vb{p}}{t} = \cancel{m \dv{\gamma}{t}\vb{v}} + \gamma m \dv{\vb{v}}{t} =
  \gamma m \dv{\vb{v}}{t}
\end{align*}}, which in the cgs\sidenote{Be advised that it is very easy to get
confused when switching between the cgs and the MKS systems, here. The Lorentz
force in MKS reads
$$
\dv{\vb{p}}{t} = q (\vb{v} \cross \vb{B})
$$
and the extra factor $c$ at the denominator in cgs propagates to all the other
relevant equations, including the expression for the gyroradius and the definition
of the rigidity. In a nutshell: in MKS electric and magnetic fields have different
dimensions (with the latter measured in Tesla) and Maxwell's equations contain
the $\epsilon_0$ and $\mu_0$ constants. In cgs Maxwell's equations are symmetric
in $\vb{E}$ and $\vb{B}$, and the latter is measured in Gauss, with
$$
1~\text{T} = 10^{4}~\text{G}.
$$
Since astronomers like to measure magnetic fields in G and experimental particle
physicist in T, there isn't a clear winner here.} system reads
\begin{align}
  \dv{\vb{p}}{t} = \gamma m \dv{\vb{v}}{t} = \frac{q}{c} (\vb{v} \cross \vb{B}).
\end{align}


\section{Motion in a uniform magnetic field}

Let us consider a uniform and stationary magnetic field $\vb{B}$. In this case
the motion can be decomposed into a part parallel to the magnetic field, whose
solution is trivial
\begin{align*}
  \dv{\vb{p}_\parallel}{t} = 0
  \quad\text{or}\quad
  \vb{p}_\parallel = \text{const},
\end{align*}
and a part orthogonal to the magnetic field
\begin{align*}
  \dv{\vb{p}_\perp}{t} = \frac{q}{c} (\vb{v}_\perp \cross \vb{B}).
\end{align*}
This is also easily integrated noting that the momentum change is always
perpendicular to the velocity, and the latter does only change in direction, not
in magnitude. The solution, when projected onto a plane perpendicular to the
magnetic field, is a circular motion whose radius is dictated by the condition
that the centrifugal force balances the Lorentz force
\begin{align}\label{eq:gyrorad}
  m \gamma \frac{v_\perp^2}{\gyrorad} = \frac{qv_\perp B}{c}
  \quad\text{or}\quad
  \gyrorad = \frac{m\gamma v_\perp c}{qB} = \frac{p_\perp c}{qB} =
  \frac{pc\sin\theta}{qB}.
\end{align}
This is customarily called the cyclotron radius or  the \emph{gyroradius}\sidenote{The
corresponding formula in MKS is
$$
\gyrorad = \frac{p\sin\theta}{qB}.
$$}, and it
is an important parameter characterizing the motion of a particle into a magnetic
field. The angle $\theta$ between the velocity and the magnetic field is usually
referred to as the \emph{pitch angle}. The quantity
\begin{align}
  \rigidity = \frac{pc}{q}~\text{[V]}
\end{align}
is called the \emph{rigidity}\sidenote{The rigidity is an important concept
because two particles with the same rigidity behave in the same way in a magnetic
field, no matter what the specific values of the momentum and charge are. Most
notablly, a magnetic spectrometer measures the rigidity. By the way: in MKS
the rigidity is naturally defined as
$$
\rigidity = \frac{p}{q}~\text{[T~m]}
$$}
of the particle, and allows to rewrite the expression for the gyroradius as
\begin{align*}
  \gyrorad = \rigidity \frac{\sin\theta}{B}.
\end{align*}

\begin{figure}[htbp!]
	\input{figures/gyroradius.pgf}
	\caption{The gyroradius of a particle with unitary charge (e.g., a proton)
    in a magnetic field as a function of its rigidity for different magnetic
    field strengths, and assuming a pitch angle of $90^\circ$ ($\sin\theta=1$).
    For reference, the gyroradius of a particle with rigidity of 1 GV in a
    magnetic field of 1~T is about 3.3~m}
\end{figure}


As we shall see in a second, the concept of gyroradius is in fact important not
only for the case of a uniform magnetic field, since even in inhomogeneous fields
particles tend to exhibit a characteristic gyromotion, coupled to a drift along the
field lines. For completeness, the period, frequency and angular frequency of
this motion are given by
\begin{align}
  T_\gyrorad = \frac{2\pi \gyrorad}{v_\perp} = \frac{2\pi m \gamma c}{qB}, \quad
  \nu_\gyrorad = \frac{qB}{2\pi m \gamma c} \quad\text{and}\quad
  \omega_\gyrorad = \frac{qB}{m \gamma c}.
\end{align}


\section{Adiabatic invariants}

The motion of a particle in a inhomogeneous magnetic field gets typically complicated
very quickly, and in most cases the only complete solution of the problem is via
a numerical ray-tracing of the particle. Adiabatic invariants, however, provide
a useful way of understanding the basic properties of the motion in a simple fashion.

It is known from classical mechanics that when the Hamiltonian of a one-dimensional,
periodic system depends on one or more parameters that change
\emph{slowly}\sidenote{By slow, here we mean that the fractional change of the
energy of the system in one period is much smaller than unity.} in time, the line
integral
\begin{align}\label{eq:adiabaitic_invariant_1d}
  J = \oint p \diff{q}
\end{align}
is approximately constant. Here $p$ and $q$ are a pair of canonically conjugate
variables, the integral is performed over a closed orbit of the system, and
the action $J$ is called an \emph{adiabatic invariant}. From a geometrical standpoint,
$J$ represents the area of the phase space enclosed in a closed orbit, and it is
easy to see that the line integral~\eqref{eq:adiabaitic_invariant_1d} can be
expressed in the equivalent form
\begin{align*}
  J = \int\int \diff{p} \diff{q}.
\end{align*}

\begin{marginfigure}
  \input{figures/adiabatic_invariant.pgf}
  \caption{Trajectory of the periodic motion of a harmonic oscillator in the phase space.}
  \label{fig:adiabatic_invariant}
\end{marginfigure}

This is best illustrated by a harmonic oscillator whose angular frequency $\omega$
changes slowly with time. The Hamiltonian reads
\begin{align*}
  H = \frac{p^2}{2m} + \frac{m\omega^2 q^2}{2}
\end{align*}
and, for any given value of the energy $E$ of the system, the trajectory in the
phase space is an ellipse with semi-axes $\sqrt{\nicefrac{2E}{m\omega^2}}$ and
$\sqrt{2mE}$, and the area of the ellipse is
\begin{align*}
  J = 2\pi \frac{E}{\omega},
\end{align*}
that is, when $\omega$ changes adiabatically, the energy $E$ changes of the same
fractional amount.

This can be generalized to systems with more than one degree of freedom, and to
systems with more than one periodicity. In the latter case at each periodicity
corresponds a distinct adiabatic invariant.


\section{Motion in inhomogeneous magnetic fields}

In plasma physics it is customary to define two invariants for the motion of a
charged particle in a magnetic field: the first is related to the the gyration
motion around the field lines, and the second is related to the periodic bouncing
between magnetic mirroring points, when they exist. This also applies to geomagnetically
trapped radiation, where a third periodic motion (a slow east-west drift about
the Earth), and therefore a third invariant can be defined. Since the trajectory
of a particle in a inhomogeneous magnetic field can be arbitrarily complicated,
adiabatic invariants are extremely useful to characterize in simple terms the
properties of a system.

For illustrative purpose we shall calculate explicitly the first plasma adiabatic
invariant $J_1$ deriving from the gyration motion around the field lines, which
will be approximately constant for a magnetic field whose fractional variations
in time and space are small within a single period of the motion and across a gyroradius.
Since the canonical momentum of a charged particle moving in a magnetic field with
vector potential $\vb{A}$ is $\vb{p} + \nicefrac{q}{c} \vb{A}$, we can write the
adiabatic invariant as
\begin{align}
  J_1 = \oint \qty[\vb{p} + \frac{q}{c} \vb{A}] \dotproduct d\vb{l} =
  2\pi\gyrorad p_\perp + \frac{q}{c} \oint \vb{A} \dotproduct d\vb{l}.
\end{align}
The last line integral can be transformed into a flux across the surface $S$ enclosed
by the orbit by virtue of the Stokes' theorem
\begin{align*}
  \oint \vb{A} \dotproduct d\vb{l} = \int_S \curl{\vb{A}} \dotproduct d\vb{S} =
  \int_S \vb{B} \dotproduct d\vb{S} = -\pi \gyrorad^2 B,
\end{align*}
where $B$ is the absolute value of the magnetic field, assumed to be constant within
a single orbit\sidenote{The negative sign is due to the fact that the vector $d\vb{S}$
defined by the orbit of the particle is antiparallel to $B$. This is a general
principle related to Lenz's law.}.

Now, the two terms in our invariant contains both $p_\perp$ and $\gyrorad$, which
are not independent, as either one can be written in terms of the other using
equation~\eqref{eq:gyrorad}---by doing which we realize that the second is in fact
exactly a half of the first (with the opposite sign), and the sum reads
\begin{align}
  J_1 = \frac{\pi p_\perp^2 c}{qB} = \frac{\pi \gyrorad^2 qB}{c}.
\end{align}
We note, in passing, that the expression for $J_1$ as a function of the transverse
momentum makes it immediately obvious that the first adiabatic invariant is
proportional to the quantity
\begin{align*}
  J_1 \propto \mu = \frac{p_\perp^2}{2mB}
\end{align*}
which is customarily called the \emph{magnetic moment} of the motion, since it is
easy to show that it reduces to the actual magnetic moment of the current loop
induced by the particle gyromotion in the non-relativistic limit\sidenote{Here
$i = \nicefrac{q}{T\gyrorad}$ denotes the current associated to the moving change,
and $S = \pi \gyrorad^2$ is the surface of the loop. Note that, in the expression
for the gyroradius we have set $\gamma = 1$ since we are in the non-relativistic
case.}
\begin{align*}
  \mu_\text{NR} = \frac{iS}{c} = \frac{q \pi \gyrorad^2}{T_\gyrorad c} =
  \frac{m v_\perp^2 }{2 B} = \frac{\kine_\perp}{B}
\end{align*}

It is also worth mentioning that the conservation of the magnetic moment in the
non relativistic case can be demonstrated directly for a uniform magnetic field
slowly varying in time. The time derivative of $\mu_\text{NR}$ reads
\begin{align}\label{eq:nr_mu_tder}
  \dv{\mu_\text{NR}}{t} =
  \frac{1}{B}\pdv{\kine_\perp}{t} - \frac{\kine_\perp}{B^2}\pdv{B}{t},
\end{align}
which includes two separate terms---one due to the (slow) change in kinetic energy
(and hence transverse velocity, and hence gyroradius) and the other due to the (slow)
change of magnetic field. As it turns out, the two are not independent, as the variation
of kinetic energy is in turn due to the electromotive force
\begin{align*}
  \curl\vb{E} = -\frac{1}{c}\pdv{\vb{B}}{t}.
\end{align*}
induced by the time variation of the magnetic field. In order to show that the
magnetic moment is constant in time, we can therefore calculate the change in
transverse kinetic energy in a full revolution as
\begin{align*}
  \Delta \kine = \oint q\vb{E} \dotproduct d\vb{l} =
  q \int_S \curl \vb{E} \dotproduct d\vb{S} =
  - \frac{q}{c} \int_S\pdv{\vb{B}}{t} \dotproduct d\vb{S} =
  \frac{q\pi \gyrorad^2}{c} \pdv{B}{t}
\end{align*}
(note that, as usual, the magnetic field and the surface element vector are antiparallel,
hence the additional minus sign in the last passage) and since the rate of variation
is constant through a period, the time derivative of the transverse kinetic energy as
\begin{align*}
  \pdv{\kine_\perp}{t} = \frac{\Delta \kine}{T_\gyrorad} =
  \frac{v_\perp}{2\pi\gyrorad} \frac{q\pi \gyrorad^2}{c} \pdv{B}{t} =
  \frac{v_\perp q \gyrorad}{2c}\pdv{B}{t} = \frac{\kine_\perp}{B}\pdv{B}{t}.
\end{align*}
By plugging this equation into~\eqref{eq:nr_mu_tder} we see that the time derivative
of $\mu_\text{NR}$ vanishes, as expected.

Either way, we have the fundamental result that the gyromotion in a slowly varying
magnetic field proceed with an approximately conserved quantities that can
be written as
\begin{align}
  \frac{p_\perp^2}{B} = \text{const}
  \quad\text{or}\quad
  \gyrorad^2 B = \text{const}.
\end{align}

This is a fundamental results as it immediately implies that, whenever a particle
is moving from a region with a weaker magnetic field toward a region with a
higher magnetic field (that is, $B$ increases), the transverse momentum is bound
to increase as well ($\propto \sqrt{B}$, as a matter of fact) so that our first
adiabatic invariant is preserved. Since the magnetic field is not doing work and
the kinetic energy is conserved, we have that
\begin{align*}
  p_\perp^2 +  p_\parallel^2 = \text{const}
\end{align*}
and the component of the momentum parallel to the magnetic field is bound to
decrease---\emph{charged particles feel a net repulsive force when moving in
the direction of a magnetic field gradient} at the point that, under suitable
conditions, the parallel velocity can get to zero and change sign, and a magnetic
field gradient can act as a magnetic mirror. This is the very principle at the basis
of plasma confinement, it is one of the fundamental mechanisms at the base of the
geomagnetically trapped radiation, and is one of the ingredients of the Fermi
first order acceleration mechanism.

The parallel with the magnetic moment is actually more profound that we have
sketched here, as a particle undergoing gyration motion acts like a small loop
of current, and the component of the force parallel to the magnetic field is
essentially that of a inhomogeneous magnetic field acting on a magnetic moment
\begin{align}
  F_\parallel = -\frac{\mu}{\gamma c}\pdv{B}{s}
\end{align}
Since the motion of the particle (and hence the current) is induced by the field
itself, the force is always repulsive.
