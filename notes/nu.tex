\chapter{Massive Neutrinos}

The electron neutrino was was first hypothesized, although under a different name,
by W. Pauli in 1930 in order to save the energy conservation law in $\beta$ decay,
incorporated by Fermi a few years later into its effective theory of the process,
and detected experimentally\sidenote{To be precise, that was the antineutrino.} in 1956.
As the two hevier leptons (first the $\mu$ and then the $\tau$) were discovered, it
was postulated that they would come with their fellow neutrinos, and in fact $\nu_\mu$
was observed in 1962, and $\nu_\tau$ in 2000. We now have a fairly precise understading
of the three generations (or \emph{flavors}) of neutrino, their properties and
mixing, although a number of open problems is still object of active investigation.

In this section we shall use a hybrid approach, where we shall partially follow
the historical development of our understanding of the neutrinos, staring from the
saga of the solar neutrinos, which has its own special place in the history of science
as an endevour undertaken by a relatively small number of key people when that particular
subject of study was not fashionable and the very idea that the Sun could provide
quantitative information into the basic costituents of the matter was met with skepticism.
We shall interleave the history of the solar neutrino problem with the basic treatment
of two-flavor neutrino oscillation and neutrino propagation in matter (also know as
MSW effect), cover the atmospheric neutrinos, and the try and put everything into the
big picture of our current understading of three-flavor mixing, with a final outlook
to future developments and open problems.

% Interesting review on all neutrino measurements by Lino Miramonti (Milan)
% https://www0.mi.infn.it/~miramont/menu/attivita_didattica/Fisica_delle_Particelle_4_Astroparticelle/lec_oscillations.pdf
% and also
% https://wwwth.mpp.mpg.de/members/raffelt/Vorlesungen/WS2009/notes/notes13.pdf


\section{Solar neutrinos}

%https://www.fe.infn.it/radioactivity/fiorentini/materials/courses/astronuc_en/5.%20Nuclear%20reactions%20in%20the%20sun.pdf

Solar neutrinos, produced in the core of the Sun via various nuclear fusion process,
make up for the vast majority of the neutrinos reaching the Earth and, since, unlike
photons, they can largely travel unperturned through the Sun, they provide crucial
information about the inner functioning of our star---as well as about the neutrinos
themselves, as we shall see in a second. The saga of the \emph{solar neutrino problem}
is a long and torned one, and one where the detailed study of a mundane astrophysical
object such as the Sun proved to be carrier of a breakthrough related to the fundamental
constituents of matter, developing at the same time what is known as the standard
solar model~\cite{2003nipb.conf...15B}.

If we accept that the main mechanism generating energy in the Sun is the fusion
of $H$ into $He$---which is in agreement with the state of the art of our
understanding---then, by first principles, we have to assume that the basic reaction
by which the Sun shines is the conversion of \emph{four} protons into an $\alpha$
particle
\begin{align*}
  4p + 2 e^- \rightarrow \ce{^4He} + 2\nu_e + Q_\text{heat}
\end{align*}
which, in virtue of the conservation of the leptonic number, proceeds with the
creation of exactly two neutrinos for each reaction\sidenote{What we are doing here is
essentially to transform two out of four protons in neutrons, which is the inverse
of the neutron beta decay
\begin{align*}
  n \rightarrow p + e^- + \overline{\nu}_e
\end{align*}
and is bound to produce two neutrinos.}.
The difference between the sum of the masses in the initial state and that in the
final state is in this case $Q = 26.73$~MeV, and we can rephrase this by saying
that that we have an energy release of $26.73$~MeV associated to each pair of
neutrino being produced. These two simple facts bears important consequences,
because the \emph{total} neutrino flux at Earth can be related to the solar
constant\sidenote{In reality the situation is more complicted, as the proton fusion
can proceed via several different avenues, and a precise estimate requires an accurate
modeling of the Sun interior, but it is amusing to know that this simple calculation
is correct to the 10\% level.} (that is, the electromagnetic energy flux per unit
area at a distance $d = 1$~au from the Sun) by
\begin{align}
  \Phi_\nu = \frac{2 L_\odot}{4\pi d^2 Q_\text{heat}}.
\end{align}
If we now assume that the majority of the energy from the nuclear fusion goes into
heat, i.e., $Q_\text{heat} \sim Q$ we arrive to the astonishing figure of
$\Phi_\nu \approx 6.5 \times 10^{10}$~cm$^{-2}$~s$^{-1}$. In any given second, any
1~cm$^2$ surface orthogonal to the direction to the Sun is traversed by some
65~billion neutrinos. In the remaining of this section we shall elaborate on this
basic facts, and the reader is referred to~\cite{2021ARNPS..71..491O} for a more
in-depth, forward-looking review of neutrino production in the Sun.


\subsection{Neutrino production in nuclear fusion}

The archetypal neutrino production process in the Sun is the fusion of two protons
into a deuton (a stable hydrogen isotope consisting into a bound state of a
proton and a neutron), which takes place via the weak interaction, with the production
of a positron and a neutrino
\begin{align}\label{eq:deuton_fusion}
  p + p \rightarrow \ce{^2H} + e^+ + \nu_e + 0.423~\text{MeV}.
\end{align}

\begin{figure}[!htbp]
  \input{figures/nucleon_binding_energy.pgf}
  \caption{Caption.}
  \label{fig:nucleon_binding_energy}
\end{figure}

The fusion of light nuclei into heavier ones, at least when the atomic number is
not too large, is energetically favored because the mass of the product of the fusion
is generally smaller than the sum of the masses of the reagents, and the mass
defect is available to create secondary particles, such as the positron and the
neutrino in the previous case. This basic notion is customarily expressed in
quantitative terms by the \emph{average binding energy per nucleon} as a function
of the mass number
\begin{align*}
  \ave{E_B} = \frac{(m_p Z + m_n(A - Z) - m_N)c^2}{A}.
\end{align*}
Generally speaking, the average binding energy per nucleon increases up to the iron,
which is why fusion is an efficient mechanism to generate heavy nuclei only up
to this element. The deuton binding energy is about 2.2~MeV (or 1.1~MeV per nucleon),
while for ${^4}He$ the binding energy is roughly 28.3~MeV, or 7.1~MeV per nucleon.
For most of the elements, the average binding energy per nucleon is comprised
between 8 and 9~MeV.

Now, in order for two nuclei to be able to undergo nuclear fusion---despite the
fact that the latter is energetically favored---they have to first overcome the
Coulomb potential barrier and get close enough to each other for the (short-range)
strong force to take over. This happens at a distance $r \leq r_0 \sim 1$~fm
of the order of the proton radius. We can model the problem in a very crude way
by assuming that the nucleus-nucleus interaction potential is given by the Coulomb
potential at large distances, and collapses into a well at $r_0 \sim A^\frac{1}{3}$~fm,
that is, we can write the potential energy as\sidenote{Note we are neglecting the
angular momentum, which is legitimate here, as we are interested in nuclear interactions
with a small impact parameter (otherwise the two nuclei would not get close enough
to each other), and the $s$-wave contribution is the only important term in the
partial-wave expansion.}
\begin{align*}
  U(r) =
  \begin{cases}
    \displaystyle\frac{Z_1 Z_2 e^2}{r} & r > r_0\\
    -U_0 & r \leq r_0.
  \end{cases}
  \quad\text{and}\quad
  U_\text{max} = U(r_0) = \frac{Z_1 Z_2 e^2}{r_0}
\end{align*}

\begin{marginfigure}
  \input{figures/pp_fusion.pgf}
  \caption{Schematic representation of the central potential describing the process
  of nuclear fusion process fusion as a well and a Coulomb barrier.}
  \label{fig:pp_fusion}
\end{marginfigure}

In a classical description, a nucleus is simply forbidden from entering the potential
well (and undergo the fusion process) unless its kinetic energy is larger than $U_\text{max}$.
If we plug in the numbers, this turns out to be about $1.44$~MeV for proton-proton
fusion, and larger for heavier nuclei. The question is now: what are the chances
for a nucleus (e.g., a proton) in the core of the Sun to have a kinetic energy in
excess this value?

If we model the core of the Sun as a non-relativistic perfect gas (or, more
precisely, as a plasma of protons and electrons, since the atoms are completely
ionized), the probability density function for the proton velocity is given by the
Maxwell-Boltzmann distribution
\begin{align}
  p_v(v) = \qty(\frac{m}{2\pi kT})^\frac{3}{2} 4\pi v^2 e^{-\frac{mv^2}{2kT}}
\end{align}
(with $kT \approx 1.5$~keV), which can be easily recasted in energy space by a simple
change of variables
\begin{align}\label{eq:maxwell_boltzmann_dist_energy}
  p_E(E) = \frac{2}{\sqrt{\pi}} \qty(\frac{1}{kT})^\frac{3}{2} \sqrt{E} e^{-\frac{E}{kT}}.
\end{align}

We are now facing a distinct problem: we have a potential barrier to cross for the fusion
to take place that is of the order of $U_\text{max} \approx 1.5$~MeV (or more, if we
consider heavier nuclei), but the protons at the center of the Sun only have $kT \approx 1.5$~keV
of kinetic energy available on average. Formally the probability for any given proton
to have enough energy to cross the barrier is calculated by integrating the Maxwell-Boltzmann
distribution~\eqref{eq:maxwell_boltzmann_dist_energy} from $x_0 = \nicefrac{U_\text{max}}{kT}$
to infinity
\begin{align*}
  P_\text{cross} = \frac{2}{\sqrt{\pi}} \int_{x_0}^\infty \sqrt{x} e^{-x} \diff{x} =
  \text{erfc}\qty(\sqrt{x_0}) + 2 \sqrt{\frac{x_0}{\pi}} e^{-x_0} \approx
  2 \sqrt{\frac{x_0}{\pi}} e^{-x_0}
\end{align*}
(the last approximation holds for large $x_0$), and for $x_0 = 1000$ the crossing
it is of the order of $10^{-436}$ which means that, even considering that the number of
protons in the Sun $N_p \approx N_A M_\odot~\text{[g]} \approx 1.2 \times 10^{57}$,
the process is classically forbidden.

Here is where quantum mechanics comes to rescue, as even if the crossing is classically
forbidden, there is potentially a non-zero probability of quantum tunneling. The
latter can be calculated in semi-classical (or WKB) approximation as
\begin{align*}
  P_\text{cross} = \exp\qty{-2\int_{r_0}^{r_1} \sqrt{\frac{2m_r}{\hbar^2} (U(r) - E)} \diff{r}},
\end{align*}
where $m_r$ is the reduced mass of the two particle (i.e., $\nicefrac{m_p}{2}$ for
a proton-proton fusion) and $r_1$ is defined by the condition\sidenote{It is important
to note that figure~\ref{fig:pp_fusion} is not quite to scale: since the kinetic
energy $E$ of the nucleus is typically much smaller than the height of the Coulomb
barrier $U_\text{max}$, we have $r_0 \ll r_1$ or, equivalently, $\nicefrac{r_0}{r_1} \ll 1$.}
$U(r_1) = E$. We can then rewrite our probability as
\begin{align*}
  P_\text{cross} = \exp\qty{-2 \sqrt{\frac{2m_r Z_1 Z_2 e^2}{\hbar^2}}
  \int_{r_0}^{r_1} \sqrt{\frac{1}{r} - \frac{1}{r_1}} \diff{r}},
\end{align*}
which, by virtue of the change of variable $x = \nicefrac{r}{r_1}$, becomes
\begin{align*}
  \int_{r_0}^{r_1} \sqrt{\frac{1}{r} - \frac{1}{r_1}} \diff{r} =
  \frac{e}{\sqrt{E}} \int_\frac{r_0}{r_1}^{1} \sqrt{\frac{1}{x} - 1} \diff{x}
  \approx \frac{e}{\sqrt{E}} \int_0^1 \sqrt{\frac{1}{x} - 1} \diff{x} =
  \frac{\pi}{2} \frac{e}{\sqrt{E}}.
\end{align*}
(in the penultimate passage we have used the fact that $\nicefrac{r_0}{r_1}$ is
small to change the lower limit if the integration to zero). The crossing probability
can be estimated as
\begin{align}
  P_\text{cross} = \exp\qty{-\pi e^2 Z_1 Z_2 \sqrt{\frac{2m_r}{\hbar^2 E}}}
  \quad\text{or}\quad
  P_\text{cross} = e^{-\sqrt{\frac{E_G}{E}}},
\end{align}
where we have introduced the \emph{Gamow energy}
\begin{align}
  E_G = \frac{2m_r \pi^2 e^4 Z_1^2 Z_2^2}{\hbar^2},
\end{align}
which turns out to be of the order of $493$~keV for a proton-proton fusion. The corresponding
crossing probability, assuming an average proton energy of 1.5~keV, is now of the
order of $10^{-8}$---this is still small for a single proton, but when we fold in
the number of protons available in the Sun, this is more than enough for the process
to actually take place.

Although we will not go into all the gory details of a complete calculation of the
neutrino flux from nuclear fusion, we note the thermonuclear reaction rate is
customarily written as
\begin{align}
  N_A \ave{\sigma v} = N_A \qty(\frac{8}{\pi m_r})^\frac{1}{2} \qty(\frac{1}{kT})^{\frac{3}{2}}
  \int_0^\infty S(E)
  \overbrace{\exp\qty{-\qty(\sqrt{\frac{E_G}{E}} + \frac{E}{kT})}}^\text{Gamow peak} \diff{E},
\end{align}
where $S(E)$, also known as the $S$-\emph{factor} or the \emph{astrophysical factor}
is motivated by a common parametrization of the nuclear cross section\sidenote{More
precisely, the nuclear cross section is written as
\begin{align*}
  \sigma(E) = \frac{S(E)}{E} e^{-\sqrt{\frac{E_G}{E}}}
\end{align*}
and the energy at the denominator cancels with the product of the $\sqrt{E}$ in the
Maxwell-Boltzmann distribution times the relative velocity, which also scales as
$\sqrt{E}$. Away from resonances, the $S$-factor is only slowly dependent on the energy.}.
We note explicitely that one of the terms that go into the relevant integral is
the product of the exponential in the Maxwell-Boltzmann distribution and the tunneling
probability, which is generally referred to as the \emph{Gamow peak} and is shown
for reasonable values of the parameters in figure~\ref{fig:gamow_peak}.

\begin{marginfigure}
  \input{figures/gamow_peak.pgf}
  \caption{Illustration of the Gamow peak for $E_G = 600$~keV and $kT = 1.5$~keV.}
  \label{fig:gamow_peak}
\end{marginfigure}

Trying to gauge the temperature dependence of the neutrino flux is an interesting
exercise for several reasons that will be clear in a second. If we let
\begin{align*}
  -f_G(E) = \sqrt{\frac{E_G}{E}} + \frac{E}{kT},
\end{align*}
it is easy to show that the function has a minimum (and therefore the Gamow peak
has a maximum) for
\begin{align}
  E_0 = E_G^\frac{1}{3} \qty(\frac{kT}{2})^\frac{2}{3}
  \quad\text{with}\quad
  -f(E_0) = \frac{3E0}{kT} = 3 \qty(\frac{E_G}{4kT})^\frac{1}{3} \coloneqq \tau.
\end{align}
We note that $E_0 \approx 6.5$~keV, and therefore $\tau \approx 13$, for a two-proton reaction.
Under the assumption that the astrophysical factor does not vary significantly within
the energy range subtended by the Gamow peak, we can take $S(E)$ out of the integral
\begin{align*}
  N_A \ave{\sigma v} = N_A \qty(\frac{8}{\pi m_r})^\frac{1}{2} \qty(\frac{1}{kT})^{\frac{3}{2}}
  S(E_0) \int_0^\infty e^{f_G(E)} \diff{E}.
\end{align*}
This is still too difficult to solve analytically, but we can expand $f_G(E)$ in a
Taylor series around $E_0$ up to the second order
\begin{align*}
  -f_G(E) \approx \tau + \frac{\tau}{4E_0^2} (E - E_0)^2
  \quad\text{or}\quad
  e^{f_G(E)} = e^{-\tau} \exp\qty{-\frac{\tau}{4E_0^2} (E - E_0)^2},
\end{align*}
from which it appears evident that all we have done is to approximate the Gamow
peak with a Gaussian with mean $\mu = E_0$ and standard deviation
\begin{align*}
  \sigma = \frac{2E_0}{\sqrt{\tau}} =
  \frac{2}{3} kT \sqrt{\tau} = \frac{2}{\sqrt{3}} (E_0 kT)^\frac{1}{2}.
\end{align*}

\begin{marginfigure}
  \input{figures/gamow_peak_gaussian.pgf}
  \caption{Illustration of the Gaussian approximation of the Gamow peak for
  $E_G = 600$~keV and $kT = 1.5$~keV.}
  \label{fig:gamow_peak_gaussian}
\end{marginfigure}

The standard deviation of our approximate Gaussian is germane to the harmonic mean
of $kT$ and $E_0$, and always smaller than the latter---in the two-proton case it
turns out to be $3.7$~keV, so that the left intergration extreme is about
$2\sigma$ away from the mean, and we are not very far off if we perform the integration
over the entire real axis, which now can be done analytically and amounts to
\begin{align*}
  \int_0^\infty e^{f_G(E)} \diff{E} = \sqrt{\pi} e^{-\tau} \frac{2E_0}{\sqrt{\tau}}.
\end{align*}
This all said, we have an expression for our reaction rate in the form\sidenote{The
relevant scalings here, are $\tau \propto T^{-\frac{1}{3}}$, and
$E_0 \propto T^\frac{2}{3}$.}
\begin{align}
  R \propto \tau^2 e^{-\tau}
\end{align}
and if, for any given value of $\tau$, we want to calculate the index of the power
law that best fits the temperature dependence of the neutrino rate, all we have
to do is calculate the logarithmic derivative
\begin{align}
  \dv{\log R}{\log T} = 2 \dv{\log \tau}{\log T} - \dv{\tau}{\log T} =
  (2 - \tau) \dv{\log \tau}{\log T} = \frac{\tau - 2}{3}.
\end{align}
For the two-proton case, where $\tau \approx 14$, the neutrino production rate scales
roughly as the fourth power of the temperature; for heavier nuclei the scaling is
even more violent, and we shall get back to this in the next section.\todo{We should
clarify the connection between this and the scaling of the different neutrino
spectra with temperature.}


\subsection{Neutrino production in the Sun}

Neutrinos are produced in the Sun via thermonuclear reactions primarily via the
so-called $pp$~cycle, with a subdominant contribution from the fusion of heavier
elements---the CNO~cycle, that is only important for stars heavier than the Sun
and we shall not describe in any detail here. The $pp$~cycle consist in the fusion
of protons into He~nuclei to the chain of reactions listed in table~\ref{tab:pp_cycle},
that we shall briefly describe in the remaining of this section.

\bgroup
\def\arraystretch{1.25}
\begin{table}[!htbp]
  \begin{tabular}{lllll}
    \hline
    No. & Reaction & Q [MeV] & $\nu_e$ energy [MeV] & $\tau$~[yr]\\
    \hline
    \hline
    1 & $\ce{^1H} (p,~e^+ \nu_e) \ce{^2H}$ & 1.442 & $< 0.423~\ave{0.265}$ & $10^{10}$\\
    2 & $\ce{^1H} (pe^-,~\nu_e) \ce{^2H}$ & 1.442 & 1.442 & $10^{12}$\\
    3 & $\ce{^2H} (p,~\gamma) \ce{^3He}$ & 5.494 & - & $10^{-8}$\\
    4 & $\ce{^3He} (p,~e^+ \nu_e) \ce{^4He}$ & 19.795 & $< 19.795~\ave{9.625}$ & $10^{12}$\\
    5 & $\ce{^3He} (\ce{^3He},~2p) \ce{^4He}$ & 12.860 & - & $10^{5}$\\
    6 & $\ce{^3He} (\ce{^4He},~\gamma) \ce{^7Be}$ & 1.586 & - & $10^{6}$\\
    7 & $\ce{^7Be} (e^-,~\nu_e) \ce{^7Li}$ & 0.384,~0.862 & 0.384,~0.862 & $10^{-1}$\\
    8 & $\ce{^7Li} (p,~\alpha) \ce{^4He}$ & 17.347 & - & $10^{-5}$\\
    9 & $\ce{^7Be} (p,~\gamma) \ce{^8B}$ & 0.137 & - & $10^{2}$\\
    10 & $\ce{^8B} (e^+ \nu_e) \ce{^8Be}^* (\alpha) \ce{^4He}$ & 17.980 & $< 17.980~\ave{6.710}$ & $10^{-8}$\\
    \hline
  \end{tabular}
  \caption{Basic nuclear reactions of the $pp$~cycle in the Sun, with the associated
  $Q$, the energy going into neutrinos (when relevant) and the approximate lifetime
  (adapted from~\cite{1988RvMP...60..297B}). Note that, due to space constraints,
  we use the compact notation, where
  \begin{align*}
    A (b, c) D
  \end{align*}
  is equivalent to
  \begin{align*}
    A + b \rightarrow c + D.
  \end{align*}}
  \label{tab:pp_cycle}
\end{table}
\egroup

As we said, the simplest nuclear fusion process is the fusion of two protons into a
deuterium nucleus (i.e., a nucleus comprise of a proton and a neutron)
\begin{align*}
  p + p \rightarrow \ce{^2H} + e^+ + \nu_e + 0.423~\text{MeV},
\end{align*}
producing a netrino with a continuous spectrum ($pp$) extending to 0.423~MeV and
and average energy of 0.265~MeV. Since the positron annihilates immediately with
an electron of the environment into two gamma rays, the very same reaction is
sometimes written as
\begin{align*}
  p + e^- + p \rightarrow \ce{^2H} + \nu_e + 2\gamma + 1.442~\text{MeV},
\end{align*}
where the $Q$ value of the reaction now explicitely includes the energy going into
the two photons in the final state, whereas the maximum neutrino energy is still
$0.423$~MeV\sidenote{Interestingly enough, a deuton can be also formed by electron
capture in the so called $pep$ reaction
\begin{align*}
  p + e^- + p \rightarrow \ce{^2H} + \nu_e + 1.442~\text{MeV}
\end{align*}
which proceeds with no photons in the final state, producing monochromatic neutrinos
at $1.44$~MeV. Being a real three-body reaction, it is much less frequent in the Sun.}.
We note that the annihilation gamma rays are not always explicitely indicated in
the reaction because, as opposed to the neutrinos (which can traverse the Sun largely
undisturbed), they are quickly degraded in energy and contribute to the thermonuclear
heat being generated.

Being mediated by the weak nuclear interaction, the deuton production is comparatively
slow. Once created, though, the deuton does not last very long, producing a $\ce{^3He}$
isotope via a reaction meadiated by the strong nuclear force (and therefore much faster)
\begin{align*}
  \ce{^2H} + p \rightarrow \ce{^3He} + \gamma + 5.494~\text{MeV}.
\end{align*}

\begin{figure}[!htbp]
  \input{figures/sun_neutrino_spectra.pgf}
  \caption{Summary of all the neutrino spectral components from the $pp$ cycle. For
  completeness the neutrino spectra from the CNO cycle are also shown with dashed
  lines. Note that continuous spectra are shown in units of cm$^{-2}$~s$^{-1}$~(100~keV)$^{-1}$,
  while lines from electron-capture reactions are shown in units of cm$^{-2}$~s$^{-1}$,
  so any visual comparison between the correspon normalization should be done
  \emph{cum grano salis}.}
  \label{fig:sun_neutrino_spectra}
\end{figure}

At this point the chain of fusion reactions can proceed via different avenues, all
ending up with a $\ce{^2He}$, whose relative importance is determined by the temperature
at which the process takes place. In the Sun, the most probable reaction is the so
called $pp$-I branch, or
\begin{align*}
  \ce{^3He} + \ce{^3He} \rightarrow \ce{^4H} + p + p + 12.860~\text{MeV}.
\end{align*}
The entire branch $p$-$p$-I is sometimes written more compactly as a single
reaction with the proper sum of the $Q$ values
\begin{align*}
  4p + 2e^- \rightarrow \ce{^4H} + 2\nu_e + 26.73~\text{MeV}.
\end{align*}
It is worth noting that, out of the $26.73$~MeV available, at most $0.84$~MeV can
go into neutrinos, and $0.53$~MeV (or 2\%) on average, which is consistent with the
assumption we have made at the beginning of the section when estimating the total
neutrino flux from the Sun electromagnetic luminosity.

The other two branches of the $pp$ chain, customarily referred as $pp$-II and $pp$-II,
proceed via the synthesis of heavier nuclei, with two distinct reactions producing
electron neutrinos: the electronic capture by $\ce{^7Be}$
\begin{align*}
  \ce{^7Be} + e^- \rightarrow \ce{^7Li} + \nu_e + 0.384~\text{or}~0.862~\text{MeV},
\end{align*}
producing monochromatic\sidenote{The neutrino spectrum is a sharp line because this
process has two bodies in the final states, as opposed to channels with three bodies
in the final state, producing continuous spectra.} neutrinos at two distinct energies,
corresponding to the ground state and an excited (metastable) state of the daughter
$\ce{^7Li}$ nucleus, and the decay of $\ce{^8B}$
\begin{align*}
  \ce{^8B} \rightarrow \ce{^8Be} + e^+ + \nu_e + 17.980~\text{MeV},
\end{align*}
producing a continuous spectrum extending to almost 20~MeV.

There is one last reaction producing neutrino that we have left out (number~4 in
table~\ref{tab:pp_cycle}), which goes under the name of $hep$, or $pp$-IV
\begin{align*}
  \ce{^3He} + p \rightarrow \ce{^4He} + e^+ + \nu_e + 19.795~\text{MeV}
\end{align*}
producing again a continuous spectrum extending to almost 20~MeV.

\begin{figure}[!htbp]
  \input{figures/sun_neutrino_location.pgf}
  \caption{Radial profiles of the neutrino production for the most important
  components of the pp cycle. (All the curves are intended as probability density
  functions, i.e., they are normalized to unity). In general terms, higher energy
  neutrinos are produced closer to the center of the Sun, where the temperature
  is higher.}
  \label{fig:sun_neutrino_location}
\end{figure}



\subsection{Solar neutrino experiments}

The fact that the Sun was an ideal source to study neutrinos was widely accepted in
the 1960s, although accompanyied by a distinct skeptikism that the knowledge of the
underlying physical processes and the environmental conditions in the Sun would
ever be known to the precision necessary for a meaningful comparison with the theory.

The history of the measurement of Solar neutrino is a long and difficult one, and
begins with the Brookhaven Solar Neutrino Experiment, performed in the Homestake
gold mine (South Dakota) in the late 1960s, under the lead of Raymond Davis and
John Bahcall. The experimental setup was based on 615~ton of perchloroethylene
($\ce{C_2Cl_4}$), placed $\sim 1500$~m underground to mitigate the large cosmic-ray
background, and the basic reaction exploited was
\begin{align*}
  \nu_e + \ce{^37Cl} \rightarrow \ce{^37Ar} + e^-,
\end{align*}
with a kinematic threshold of 814~keV on the neutrino energy. This is a particular
case of the radiochemical detection method\sidenote{The fact that the inverse beta
decay could be used to detect neutrinos via the radiactive decay of the dauther nucleus
was originally proposed by B.~Pontecorvo in 1946~\cite{1946PontecorvoInvBeta}.
Interestingly enough, the original paper lists all the necessary characteristic of
the active medium to be used: it has to be cheap, due to the large volumes involved,
the lifetime of the radiactive nuclide produced in the process must be long enough,
the separation of the radiactive atoms from the bulk of the medium must be simplem
and the threshold for the reaction must be as low as possible (clorine was identified
as a prime candidate).}, that relies on nuclear neutrino capture
(or \emph{inverse $\beta$ decay})
\begin{align*}
  \nu_e + (A,~Z) \xrightarrow[\text{decay}]{\text{capture}} (A,~Z+1) + e^-,
\end{align*}
where the product nuclide then experiments $\beta$ decay back to the original one
with some characteristic half-life $T_\frac{1}{2}$ (about 35~days for $\ce{^37Ar}$).
Radiochemical experiments are peculiar in that they are run in \emph{batch} mode
(as opposed to \emph{real time} mode): the target is exposed to neutrinos for periods
of time of the order of $T_\frac{1}{2}$, and then the products of neutrino captures
are separated and removed through chemical methods (e.g., bubbling He in the case
of Homestake), and need to be converted in suitable gaseous form for the subsequent
$\beta$ decays to be measured by proportional counters in low-radioactivity environments.
The challenges connected with the choice of the target nucleus---beyond the fact
for it to be amenable to inverse $\beta$ decay---are availability in large quantities
(and with high enough purity) as well as the need for practical threshold and
half-life values.

In the case of Homestake, with about $10^{31}$ target Cl atoms, the expected rate
was of the order of a few tens of neutrino interactions per months---that is, a
few tens of radioactive $\ce{^37Ar}$ atoms that needed to be removed every month
to measure their $\beta$ decay, which gives an idea of the extraordinary difficulty
of the experiment. The first result of the experiment~\cite{1968PhRvL..20.1205D}
was an upper limit that was a factor $\sim 2.5$ below the prediction of the standard
solar model described in the previous section, while additional data~\cite{1998ApJ...496..505C}
provided a measured flux of $2.56 \pm 0.16~(\text{stat}) \pm 0.16~(\text{sys})$~SNU\sidenote{The solar neutrino unit (SNU) is conventionally
defined as the neutrino flux producing $10^{-36}$ captures per target atom per second
in a given experimental setup.}, to be compared with a prediction of $7.8$~SNU (with
a relatively large uncertainty, of the order of 20\%), that is, a deficit of a factor
of $\sim 3$. This constitutes the beginning of the
so called \emph{solar neutrino problem}, although in the early days, given the relatively
large uncertainities on both the measurements and the theoretical predictions, the
concern of the actors involved was quite limited.

The next chapter in the saga coincides with the gallium experiments: Gallex, running
between 1991 and 1997 in Italy, and SAGE (1989--2011) in Russia. These are radiochemical
experiments expoiting the reaction
\begin{align*}
  \nu_e + \ce{^71Ga} \rightarrow \ce{^71Ge} + e^-,
\end{align*}
which provides an exceptionally low kinematic threshold of 233.2~keV. Most notably,
such a low threshold allows access to the $pp$ neutrinos, constituting the vast
majority of the solar neutrino flux, and guarantees much higher rates of neutrino
interactions. The gallium experiments qualitatively confirmed the deficit measured
by Homestake, altough the ratio between the measured rate (77.5~SNU) and the
expected one (128~SNU) was of the order of $\sim 0.6$, almost twice the value measured
with clorine\cite{1999PhLB..447..127H}.\todo{Expand and put some reference.}

The next step is the advent of the water \cherenkov\ experiments, championed by
Kamiokande and Super-Kamiokande, an deep-underground tank containing 50~kton of
pure water equipped with $11,200$ photomultiplier tubes, operated in Japan between
1996 and 2007. The detection principle is interesting: as the nuclear neutrino
capture is suppressed in oxygen, the basic interaction mechanism for neutrinos is
the elastic scattering on the atomic electrons. This is qualitatively different from
the radiochemical experiments\sidenote{Historically, another notable difference is
that water \cherenkov\ experiments were the first to detect neutrino in real time.}
in that, while the latter are only sensitive to $\nu_e$, \emph{water \cherenkov\
experiments are sensity to all three generations of neutrinos} via the reactions:
\begin{align*}
  \nu_{e, \mu, \tau} + e^- \rightarrow  \nu_{e, \mu, \tau} + e^-
\end{align*}
(provided, of course, that the neutrino flavor is conserved at the vertex).
This is not to say that the three flavors of neutrinos all interact \emph{in the same way}:
there is a fundamental asymmetry due to the fact that ordinary matters includes
electrons but not $\mu$ and $\tau$. As a consequence, while the elastic scattering
for $\nu_e$ proceeds both with through neutral current (NC) and charged current (CC)
interactions (i.e., with the exchange of a $Z^0$ or a $W$) for $\nu_\mu$ and
$\nu_\tau$ only NC interactions are allowed---at least up to the kinematic threshold
where inelastic interactions with the production of $\mu$ (or $\tau$) leptons.
\todo{Add the relevant Feynman diagrams.}
It follows that the elastic scattering cross section on electrons is about six times
larger for electrons than for muons and tauons
\begin{align*}
  \frac{\sigma_e(\nu_e)}{\sigma_e(\nu_\mu)} \approx
  \frac{\sigma_e(\nu_e)}{\sigma_e(\nu_\tau)} \approx 6
\end{align*}
and, as we shall see in a second, this will be crucial when interpreting the results.

From an experimental point of view, although the kinetic energy threshold for an
electron to emit \cherenkov\ light in water is only $\sim 260$~keV, one needs enough
light to be able to see a signal over the electronic noise, and the actual detection
threshold for Super-Kamiokande is significantly higher---of the order of 5~MeV. It
follows that we are basically only sensitive to the $\ce{^8B}$ neutrinos, as in the
case of the clorine experiments. The range of a few-MeV electron in water is measured
in~cm (that is, much smaller than the size of the tank), which means that the \cherenkov\
light manifests itself in the form of rings, as opposed to full circles. From the
photomultiplier tubes, in addition to the physical location, we have access to the
pulse-height and time information, which allows to recover the arrival time, energy
and direction of the electrons. Since the neutrino energy $E \gg m_e c^2$, the electron
is typically scattered in the forward direction, wich means that not only we are
measuring neutrino in real time, but we can also project them back in the sky, and
confirm directly their solar origin\sidenote{This is not only worth mentioning as the
starting point of the neutrino astronomy, but it is also relevant for the background
rejection.}. In addition, the topological characteristics of the signal pattern in
the photomultiplier tubes allows for some level of discrimination between electrons
(which radiate, and tend to produce more irregular patterns) and background muons,
producing more regular circles.\todo{We might want to add a plot of the SK solar
peak?} The Super-Kamiokande measurement of the flux of $\ce{^8B}$ neutrinos, amounting
to some $0.45$ of the SSM prediction, constitutes a turning point in the solar neutrino
saga.

\begin{table}[!htbp]
  \begin{tabular}{llll}
    \hline
    Experiment & Threshold & Measured flux & Flux deficit\\
    \hline
    \hline
    Homestake & $814$~keV & $\Phi(\nu_e)$ & $0.33 \pm 0.02$~\cite{1998ApJ...496..505C}\\
    Gallex & $233.2$~keV & $\Phi(\nu_e)$ & $0.60 \pm 0.06$~\cite{1999PhLB..447..127H}\\
    SAGE & $233.2$~keV & $\Phi(\nu_e)$ & 0.$52 \pm 0.05$~\cite{1999PhRvL..83.4686A}\\
    SK & $\sim 5$~MeV & $\Phi(\nu_e)$ + \nicefrac{1}{6} $\Phi(\nu_\mu,\nu_\tau)$ &
    $0.451 \pm 0.002$~\cite{2001PhRvL..86.5656F} \\
    \hline
  \end{tabular}
  \caption{Partial compilation of the relevant solar neutrino measurements available
  at the end of the 1990s. (Note that the error bars are provided to allow for a
  meaningful comparison between different experiments, but are largely inhomogeneous,
  as the neutrino deficits are not necessarily referred to the same solar model,
  and the systematic uncertainties on the latter are not properly included.)}
  \label{tab:solar_nu_results}
\end{table}

All in all it is fair to say that, at the end of the 1990s the general solar neutrino
deficit, compared with the prediction of the standard solar model, was well established
from an experimental standpoint. There was some evidence that the effect was
energy-dependent, with the Gallium experiments (sensitive to the $pp$ component)
measuring a significant higher flux than the other, sensitive to relatively high
energy. We shall also note that, is we assume a $\nu_{\mu,\tau}$ flux comparable
of that of $\nu_e$, the SK results is not incompatible with Homestake. In the next
section we shall summarize the two pieces of information that allow to compose the
puzzle: neutrino oscillation in vacuum and the MSW effect.

%In our regime, where the typical energies are much smaller than the masses of the
%vector bosons, the $Z^0$ and $W$ propagators simplify and the weak force can be
%treated as a point interaction (a la Fermi) via the introduction of an effective
%coupling constant
%\begin{align*}
%  G_F = \frac{g_w^2}{M_W^2}
%\end{align*}

% https://www.slideserve.com/jalia/solar-neutrino-physics
% Slide 3, status of the field:
% Cl: 2.56 +- 0.23 SNU, Apj 496 (1998) 505
% Ga: 66.1 +- 3.1 SNU, PRC80 0150807 (2009)
% SK 1496 days, > 5 MeV
% 8B flux: 2.35 +- 0.02 +- 0.08 e6 cm^{-2} s^{-1}
% See plot at slide 6
% Solar experiments all consistent with SSM + 2-flavor MSW oscillations


\subsection{Two-flavor neutrino oscillation in vacuum}

The possibility that, \emph{if the neutrino mass is non zero}, neutrinos could mix
across different generations and oscillate from one flavor to another, dates back to a
seminal paper by B. Pontecorvo in 1957---the idea stemming from the analogy with
mixing in the systems of other neutral particles, such as the Kaons. The fact that
neutrino oscillations might resolve the solar neutrino problem was considered early
on in the course of the events, but the implications were so far reaching that some
sort of conclusive evidence was necessary for people to accept that this radically
new paradigm was not just a mere speculation. In this section we briefly review the
mechanism for neutrino oscillation in vacuum with two flavors\sidenote{The formalism
for the description of neutrino oscillation is much easier to develop in the context
of two-flavour mixing rather than three-flavour mixing. In addition, nature is such
that some of the keyobservations (solar and atmospheric neutrinos) can in fact be
interpreted, to a good approximation, in terms of two flavour mixing---therefore the
relevance of this discussion is not merely academic.}.

The basic idea behind neutrino oscillation is that neutrinos are created and absorbed
via the weak nuclear force as \emph{flavor} eigenstates, but then propagate, like all
other particles, as \emph{mass} eigenstate---and in a quantum field theory there is
nothing that guarantees that the two components of the lagrangian (that for the mass and that
for the interaction) can be made simultaneously diagonal. More specifically, if
$\nu_e$ and $\nu_\mu$ are the flavor eigenstates\sidenote{We are calling the two
flavor eigenstates $\nu_e$ and $\nu_\mu$ in order not to multiply the notation, but
there is absolutely nothing special to prefer these two generations to the fellow
$\nu_\tau$. The main point is that at each vertex of a weak Feynman diagram, each
neutrino has a well defined flavor (and not a defined mass).} and $\nu_1$ and $\nu_2$
are the mass eigenstate, we shall assume that a unitary tranformation exists connecting
the two representations
\begin{align*}
  \begin{pmatrix}\nu_e\\ \nu_\mu\end{pmatrix} = U
  \begin{pmatrix}\nu_1\\ \nu_2 \end{pmatrix}
  \quad\text{and}\quad
  \begin{pmatrix}\nu_1\\ \nu_2 \end{pmatrix} = U^{-1}
  \begin{pmatrix}\nu_e\\ \nu_\mu\end{pmatrix}.
\end{align*}
In two dimensions this unitary transformation is a rotation, and can be parametrized
by means of a single \emph{mixing angle}\sidenote{As we shall see, in three dimensions
the situation is more complicated, and we do have three angles and a phase, just like
in the CKM matrix.}
\begin{align*}
  U =
  \begin{pmatrix}
    \cos\theta & \sin\theta \\
    -\sin\theta & \cos\theta \\
  \end{pmatrix}
  \quad\text{and}\quad
  U^{-1} =
  \begin{pmatrix}
    \cos\theta & -\sin\theta \\
    \sin\theta & \cos\theta \\
  \end{pmatrix}.
\end{align*}
We note that for $\theta = 0^\circ$ (or $\theta = 90^\circ$, for what matters) the
flavor and mass eigenstates coincide, i.e., there is no mixing, while the latter
is maximal for $\theta = 45^\circ$, when each flavor eigenstate is an equal mixture
of the two mass eigestates and vice-versa.

If we start with a flavour eigenstate (say $\nu_e$) with a given momentum $p$ at $t=0$
\begin{align*}
  \ket{\nu(0)} = \ket{\nu_e} = \cos\theta \ket{\nu_1} + \sin\theta \ket{\nu_2},
\end{align*}
the two mass eigenstates will evolve in time each with its energy-dependent phase
\begin{align*}
  \ket{\nu(t)} =
    \exp\qty{-i\frac{E_1t}{\hbar}} \cos\theta \ket{\nu_1} +
    \exp\qty{-i\frac{E_2t}{\hbar}} \sin\theta \ket{\nu_2}.
\end{align*}
We can calculate the probability $P(\nu_e \rightarrow \nu_\mu)$ to detect our
neutrino ($\nu_e$ at $t = 0$) as $\nu_\mu$ at a generic time $t$:
\begin{align*}
  \abs{\braket{\nu_\mu}{\nu(t)}}^2 & = \sin^2\theta \cos^2\theta \;
    \abs{\,\exp\qty{-i\frac{E_2t}{\hbar}} - \exp\qty{-i\frac{E_1t}{\hbar}}}^2 = \\
  & = 2 \sin^2\theta \cos^2\theta \qty[1 - \cos\qty(\frac{(E_2 - E_1)t}{\hbar})] = \\
  & = \sin^2(2\theta)\sin^2 \qty(\frac{(E_2 - E_1)t}{2 \hbar}).
\end{align*}
Since neutrinos are ultrarelativistic in all the situations that we might come
across, we can approximate the dispersion relation as\sidenote{In the last passage
we have used the ultrarelativistic limit $pc \approx E$. Although it might be
confusing to switch back and forth two times between energy and momentum, once we
have isolated the relevant terms of the expansion the two are interchangeable, as
this is the notation customarily used in the literature.}
\begin{align*}
  E_i = \sqrt{m_i^2 c^4 + p^2 c^2} =
  pc \qty(1 + \frac{m_i^2 c^2}{p})^\frac{1}{2} \approx
  pc + \frac{m_i^2 c^4}{2pc} \approx E + \frac{m_i^2 c^4}{2E},
\end{align*}
and can plug this into our probability to get the final formula for oscillation
in vacuum
\begin{align}\label{eq:nu_two_flavor_osc_prob}
  P(\nu_e \rightarrow \nu_\mu) =
  %\sin^2 2\theta \sin^2 \qty(\frac{\Delta m^2 c^3 t}{4 \hbar p}) =
  \sin^2(2\theta)\sin^2 \qty(\frac{\Delta m^2 L}{4 \hbar c E}),
\end{align}
where we have defined\sidenote{Note that we include the $c^4$ here, so this
is really an energy (as opposed to a mass) squared.}
$\Delta m^2 = (m_2^2 - m_1^2) c^4$ and $L = ct$ is the distance traveled by the
neutrino.

Equation~\eqref{eq:nu_two_flavor_osc_prob} depends on two fundamental parameters
that we have no control on and need to be gauged through measurements. The
\emph{mixing angle} $\theta$ determines the specific mix of flavor eigenstates in
the mass eigenestates: if $\theta = 0$, then the two are the same and oscillations
do not occurr; for $\theta = 45^\circ$ the oscillation is maximal and there exist
a point (or infinite points, really) on the line of flight of the neutrino beam
where all the initial $\nu_e$ have oscillated to $\nu_\mu$. The other important
parameter is the difference of the two squared masses $\Delta m^2$: \emph{for oscillations
to occur at least of of the neutrinos must have non vanishing mass}\sidenote{The
implications of this very basic fact can hardly be overstated, as the observation
of neutrino oscillations per se is a direct proof that neutrinos are massive.}, and
the two masses must be different---otherwise we are never going to generate a
non-trivial phase difference during the propagation. It is also worth noting that,
while $\Delta m^2$ can be positive or negative, since~\eqref{eq:nu_two_flavor_osc_prob}
is even, the oscillation probability is rigorously the same if the change the sign
of $\Delta m^2$: \emph{interferometric experiments are only sensitive to the absolute value
of the difference of square masses but cannot resolve the mass hyerarchy}---we shall
come back to this in a second.

\begin{marginfigure}
  \input{figures/nu_oscillation_length.pgf}
  \caption{Neutrino oscillation length as a function of energy for the two relevant
  values of $\Delta m^2$, see section~\ref{sec:}}
  \label{fig:nu_oscillation_length}
\end{marginfigure}

Once the mixing angle $\theta$ and $\Delta m^2$ are fixed, the relevant quantity
is the phase of the second term in~\eqref{eq:nu_two_flavor_osc_prob}, which
can be conveniently rewritten as
\begin{align}
  \varphi(L, E) = \frac{\Delta m^2 L}{4 \hbar c E} =
  1.27\, \frac{\Delta m^2~[\text{eV}^2]~L~[\text{m}]}{E~[\text{MeV}]}.
\end{align}
A concept that is often found in literature and is helpful to grasp the meaning of
neutrino oscillation is that of \emph{oscillation length}
\begin{align*}
  L_\text{osc}(E) = \frac{1}{\pi} \frac{4\hbar c E}{\Delta m^2},
\end{align*}
using which the formula for the oscillation probability can can be recasted in the
equivalent form
\begin{align*}
  P(\nu_e \rightarrow \nu_\mu) =\sin^2(2\theta)\sin^2 \qty(\pi \frac{L}{L_\text{osc}}).
\end{align*}
If, for a given energy $E$ and propagation length $L$, $\varphi \ll 1$, then there
is no oscillation. The regime in which $\varphi \approx 1$ is where it is possible
to study the minimum/maximum in the oscillation behaviour.

\begin{figure}[!htbp]
  \input{figures/sun_neutrino_oscillation.pgf}
  \caption{Oscillation probability $P(\nu_e \rightarrow \nu_\mu)$ as a function of
  the distance $L$ traveled for a monochromatic 1~MeV beam, and for a gaussian beam
  with the same average energy but with a standard deviation of 100~keV. The plot is
  made assuming $\theta = 33.41^\circ$ and $\Delta m^2 = 7.41 \times 10^{-5}$~eV$^2$
  that, as we shall see in a moment, are appropriate for solar neutrino oscillations.}
  \label{fig:sun_neutrino_oscillation}
\end{figure}

An interesting situation arises when $\varphi$ is large. While for a monochromatic
neutrino beam and fixed $L$ the oscillating behavior proceed as before (and the
neutrino undergoes many oscillation cycles), in the typical case where we are dealing
with a mixture of different energies or/and propagation lengths, what we see is
effectively an average of a (quickly oscillating) trigonometric function
\begin{align*}
  \ave{\sin^2\varphi(L, E)} = \frac{1}{2}.
\end{align*}
This is illustrated in figure~\ref{fig:sun_neutrino_oscillation} with values for the
oscillating parameters appropriate for solar neutrinos: while a monochromatic 1~MeV
beam oscillates coherently according to the basic formula, in the (largely academic)
case of a gaussian beam with an energy dispersion of $10\%$, everything averages
out in a few cycles. The oscillation probability at large distance is constant and
only driven by the mixing angle
\begin{align*}
  P(\nu_e \rightarrow \nu_\mu) = \frac{1}{2} \sin^2 2\theta,
\end{align*}
and the corresponding probability of survival for the $\nu_e$ is
\begin{align*}
  P(\nu_e \rightarrow \nu_e) = 1 - P(\nu_e \rightarrow \nu_\mu) = 1 - \frac{1}{2} \sin^2 2\theta.
\end{align*}

We are now starting to see on the horizon a viable solution to the solar neutrino
problem, in the form of the oscillation of some of the electron neutrinos produced
in the Sun to other flavors. If the mixing is maximal ($\theta \sim 45^\circ$) and
the $\Delta m^2$ is such that, combined with the Sun-Earth distance results into an
accumulated phase $\varphi \gg 1$, then it is not unconceivable that a faction of
$\nu_e \lesssim 50\%$ might have oscillated, on average, before reaching the Earth.
This would be in line with the Gallium experiments, but it cannnot possibly be the
end of the story, as the discrepancy between the different experiments are still
troubling, and incorporating any king of energy dependence into this seems hopeless
at this point. The last piece of the puzzle, as we shall see in a moment, comes from
the effect of the matter that neutrino have to traverse to the emerge over the Sun
surface.


\subsection{Neutrino oscillation in the presence of matter}

When neutrino propagate in matter there is an additional important piece of the
puzzle entering the game due to the fact that, as we have already seen, while all the
three neutrino species interact with the fermions the same way through NC forward
scattering (mediated by a $Z^0$), the electron neutrino can also be forward scattered by
ordinary electrons through CC interaction (mediated by a $W$) which implies a non
trivial phase difference with respect to the other two flavour eigenstates. This
additional process (which is customarily called MSW effect) can in fact be interpreted
in terms of an effective refractive index (or, equivalently, and effective mass)
which is different for $\nu_e$ with respect to $\nu_\mu$ and $\nu_\tau$.

Let us rewrite the time evolution of the mass eigenstates for the two-flavor case
\emph{in vacuum}\sidenote{Since in this section we shall deal with several different
versions of the Hamiltonian, we shall explicitely indicate with two subscript letters
(in this order) if the latter is in vacuum or in matter (v, m) and if the explicit
formula is in the mass of flavor basis (m, f).} as
\begin{align*}
  i\hbar \pdv{t} \begin{pmatrix}\nu_1\\ \nu_2 \end{pmatrix} =
  H_\text{v,m} \begin{pmatrix}\nu_1\\ \nu_2 \end{pmatrix}
\end{align*}
where the Hamiltonian, expanded in series in the ultrarelativistic limit reads
\begin{align*}
  H_\text{v,m} =
  \begin{pmatrix}
  E_1 & 0\\
  0 & E_2\\
  \end{pmatrix} \approx
  \begin{pmatrix}
  E + \frac{m_1^2 c^4}{2E} & 0\\
  0 & E + \frac{m_2^2 c^4}{2E}\\
  \end{pmatrix}
  %= E + \frac{c^4}{2E}
  %\begin{pmatrix}
  %m_1^2 & 0\\
  %0 & m_2^2\\
  %\end{pmatrix}
\end{align*}
Since any term proportional to the $2 \times 2$ identity is only causing a common
phase that is irrelevant for the oscillation, it is useful to decompose the hamiltonian
isolating the traceless component, which is the only one that really matters to us
\begin{align*}
  H_\text{v,m} & =
  \frac{1}{2}\text{Tr}(H_\text{v,m}) I  + \qty{H_\text{v,m} -
  \frac{1}{2}\text{Tr}(H_\text{v,m}) I} =\\
  & = \qty{E + \frac{(m_1^2 + m_2^2)c^4}{4E}} I +
  \frac{\Delta m^2}{4E}
  \begin{pmatrix}
    -1 & 0\\
    0 & +1\\
  \end{pmatrix}
\end{align*}
If we now switch to the base of the flavor eigenstates, the Hamiltonian becomes
\begin{align*}
  H_\text{v,f} = U H_\text{v,m} U^\dag = \frac{\Delta m^2}{4E}
  \begin{pmatrix}
   -\cos2\theta & \sin2\theta\\
   \sin2\theta & \cos2\theta\\
  \end{pmatrix}
\end{align*}
where we have omitted all the terms proportional to the diagonal.

All of this in vacuum. When neutrinos propagate through matter, $\nu_e$ CC interactions
give rise to an extra term\sidenote{Technically there is an extra minus sign that
applies to electron antineutrinos that we omit because it is irrelevant in this
context.} in the Hamiltonian, which only affects the $\nu_e$-$\nu_e$\sidenote{And,
for completeness, all neutrino flavors interact with matter via neutral currents,
but since this contribution is proportional to the identity, it only produces a
global phase, which is irrelevant for our argument.} matrix element
\begin{align*}
  H_\text{m,f} = H_\text{v,f} +
  \begin{pmatrix}
  \sqrt{2} G_F n_e & 0\\
  0 & 0\\
\end{pmatrix}
\end{align*}
where $n_e$ is the electron density in matter, and $G_F$ is the Fermi constant.
Also for this extra term we can subtract the trace, and write the Hamiltonian in
matter in the equivalent form
\begin{align}\label{eq:msw_hamiltonian_1}
  H_\text{m,f} = \frac{\Delta m^2}{4E}
  \begin{pmatrix}
   -\cos 2\theta + \zeta & \sin 2\theta\\
   \sin 2\theta & \cos 2\theta - \zeta\\
  \end{pmatrix}
  \quad\text{where}\quad
  \zeta = \frac{2\sqrt{2}G_F n_e E}{\Delta m^2}.
\end{align}
It is important to realize that $\zeta$ can be positive or negative, depending on
the sign of $\Delta m^2$. We shall come back to this in a second, but the implications
are far reaching as, unlike purely interferometric effects, \emph{matter effect are sensitive
to the sign of the difference of mass squared}.

If we now transform this back into the basis of the (original) mass eigenstates,
$H_\text{v}$ goes back into its diagonal form, but the additional term proportional
to $\zeta$ causes non diagonal terms
\begin{align*}
  H_\text{m,m} = U^\dag H_\text{m,f} U =
  \frac{\Delta m^2}{4E}
  \begin{pmatrix}
    -1  + \zeta \cos2\theta & \zeta \sin2\theta\\
    \zeta \sin2\theta & 1 - \zeta \cos2\theta\\
  \end{pmatrix},
\end{align*}
that is, the mass eigenstates in vacuum are no longer eigenstates of the new Hamiltonian
in presence of matter. At this point we \emph{could} diagonalize the new Hamiltonian
and then transform it back into the flavor basis, but since the mixing matrix with
two generation is bound to be a simple rotation, the most general form of the final
result will be
\begin{align}\label{eq:msw_hamiltonian_2}
  H_\text{m,f} = \frac{\Delta \tilde{m}^2}{4E}
  \begin{pmatrix}
   -\cos 2\tilde{\theta} & \sin 2\tilde{\theta}\\
   \sin 2\tilde{\theta} & \cos 2\tilde{\theta}\\
  \end{pmatrix},
\end{align}
and we all we have left to do is to calculate the new, effective $\Delta \tilde{m}^2$
and $\tilde{\theta}$ by just comparing~\eqref{eq:msw_hamiltonian_2} and~\eqref{eq:msw_hamiltonian_1}.
We have two independent equations
\begin{align*}
  \begin{cases}
    \Delta \tilde{m}^2 \cos 2\tilde{\theta} & = \Delta m^2 (\cos 2\theta - \zeta)\\
    \Delta \tilde{m}^2 \sin 2\tilde{\theta} & = \Delta m^2 \sin 2\theta,
  \end{cases}
\end{align*}
that are readily solved as
\begin{align}\label{eq:matter_deltam_theta}
  \Delta \tilde{m}^2 = C(\zeta) \Delta m^2
  \quad\text{and}\quad
  \sin 2\tilde{\theta} = \frac{\sin 2\theta}{C(\zeta)},
\end{align}
where
\begin{align}
  C(\zeta) = \sqrt{(\cos 2\theta - \zeta)^2 + \sin^2 2\theta}.
\end{align}

Let us take a step back and examine the results we have obtained. If the electron
density is constant, neutrino oscillations in matter have the same basic phenomenology
we have derived in vacuum, except for the (important) fact that the effective mass
difference and mixing angle are modified according to~\eqref{eq:matter_deltam_theta}.
Since $\lim_{\zeta \rightarrow 0} C(\zeta) = 1$, we recover the initial setup in vacuum for
$\zeta \ll 1$, or, equivalently, when the electron density is sufficiently
small\sidenote{The effect is energy-dependent, and more pronounced for larger energies.
If we plug in $\Delta m^2 = 7.41 \times 10^{-5}$~eV$^2$ and $E = 1$~MeV, we get that
the critical electron number density is $n_e \approx 2 \times 10^{26}$~cm$^{-3}$.}
\begin{align*}
  n_e \ll \frac{\Delta m^2}{2\sqrt{2}G_F E}.
\end{align*}
It is interesting to note that if $\sin 2\theta = 0$, then $\sin 2\tilde{\theta} = 0$
no matter what $C(\zeta)$ amounts to: for oscillations to happen in matter, the mixing
angle in vacuum must be non-vanishing. On the other hand, when $C(\zeta)$ is very large,
$\sin 2\tilde{\theta}$ is small no matter what the mixing angle is in vacuum, that is,
when the electron number density is very large, oscillations are suprressed
altogether.

Something even more interesting happens when $\zeta = \cos 2\theta$\sidenote{Note that,
assuming that $\theta$ lies in the first quadrant, this can only take place for
$\zeta > 0$, i.e., $m_2^2 > m_1^2$. Again, matter effect are sensitive to the sign
of $\Delta m^2$.}, in that $C = \sin 2\theta$, and therefore $\sin 2\tilde{\theta} = 1$,
no matter what the original value of $\sin 2\theta$ is. In other words, \emph{the
mixing becomes maximal even if the oscillation probability in vacuum is small, and
arbitrarily so}. This resonant condition happens for
\begin{align}\label{eq:msw_resonance_energy}
  E_\text{res} = \frac{\Delta m^2 \cos 2\theta}{2\sqrt{2}G_F n_e}.
\end{align}

Up to this point we have treated $n_e$ as a number, i.e., we have operated under
the implicit assumption that the electron number density of the medium traversed by
the neutrino was constant---which is hardly the case for the Sun. If, once again, we
jump for a second all the way to the end of the story and we plug into~\eqref{eq:msw_resonance_energy}
the values of $\Delta m^2$ and $\theta$ that are appropriate for Solar neutrinos,
we find that the resonance energy at the center of the Sun, where the electron density
is $\sim 6 \times 10^{25}$~cm$^{-3}$, is of the order of 1~MeV. This means that every
neutrino created at the center of the Sun with an energy greater than 1~MeV, as it
propagates toward less dense material, will at some point come across the resonance
condition.

\begin{marginfigure}
  \input{figures/msw_resonance_energy.pgf}
  \caption{Plot of the MSW resonance energy in the Sun, as a function of the distance
  from the center. Overlaied is the pdf for the Boron neutrino production.}
  \label{fig:msw_resonance_energy}
\end{marginfigure}

MSW conversion in presence of varying electron density is customarily illustrated in
textbooks in the (somewhat fictional) two-generation, small-mixing-angle setup. This
makes the discussion easier and more intuitive, as the mass and flavor eigenstates
coincide, and, since the matter term due to CC interaction is only affecting the
first mass eigenstate, the effective mass of the second does not depend
on $n_e$. When $\theta = 0$, we have $C(\zeta) = (1 - \zeta)$, and the two mass
eigevalues read
\begin{align*}
  \begin{cases}
  \tilde{m}_1^2 & = m_1^2 + \zeta \Delta_m^2 \quad (\text{for } \nu_e)\\
  \tilde{m}_2^2 & = m_2^2 \quad (\text{for } \nu_\mu).
\end{cases}
\end{align*}
An electron neutrino created above the resonance, where the electron number density
is large (e.g. at the center of the Sun), propagating toward regions of comparatively
lower density sees it effective mass gradually decreasing, until it reaches the
resonance condition, where it is converted to a muon neutrino. At this point the
electron density is no longer high enough to support matter oscillations, and the
neutrino remains in its $\nu_\mu$ state.

\begin{marginfigure}
  \input{figures/msw_conversion.pgf}
  \caption{Sketch of the MSW resonant conversion in the illustrative case of no
  vacuum mixing (i.e., when mass and flavor eigenstates coincide). Note that
  this phenomenon only takes place if $m_1 < m_2$, otherwise the two lines do not
  cross.}
  \label{fig:msw_conversion}
\end{marginfigure}

Of course the situation in real life is more complicated, as $\nu_e$ is a mix of
$\nu_1$ and $\nu_2$, and, in the presence of a varying electron density $n_e$, the
Shroendinger equation for the evolution cannot be diagonalized along the entire path
via a simple rotation. The basic phenomenology we have described here, though,
remains qualitatively valid in the \emph{adiabatic} limit (that is, when the change
of $n_e$ is small), in which case the mass eigenstates follow fixed trajectories in the
phase space, with no level crossing, and adiabatic conversion can still occur.
In this case the evolution equation needs to be solved numerically, and we shall see
and example of such solution at the end of the next section.


\subsection{The solution of the solar neutrino problem}

\todo{Start with a short recap at of the situation at the end of the 1990s.}
One of the fundamental limitations of the early solar neautrino experiments was the
lack of sensitivity to the neutrino flavors associated to the heavier leptons. Radiochemical
experiments exploited CC interactions, and were only sensitive to $\nu_e$; water
\cherenkov\ experiments exploiting the neutrino elastic scattering used both
CC and NC currents, but had limited sensitivity to $\nu_\mu$ and $\nu_\tau$.
It appeared clear that a possible key breakthrough to the solution of the solar
neutrino problem would be an experiment sensitive to \emph{all} neutrino types. The
elastic scattering off protons, for instance
\begin{align*}
  \nu_{e, \mu, \tau} + p \rightarrow  \nu_{e, \mu, \tau} + p
  \quad\text{(NC)}
\end{align*}
would be a sensible candidate, but one where the enormous background effectively
renders the approach hopeless: all we have a few-MeV proton in the final state,
which is higly non relativistic and therefore not collinear with the incoming neutrino,
and therefore would not allow to rely on the solar peak as in SK.

Deuterium is peculiar, in this respect, in that its nucleus is only loosely bound
(the binding energy is $\sim 2.2$~MeV) and, in addition to the charged-current reaction
\begin{align*}
  \nu_e + d \rightarrow e^- + p + p \quad\text{(CC)},
\end{align*}
with a threshold of 1.4~MeV, and the ordinary elastic neutrino scattering off the
atomic electrons
\begin{align*}
  \nu_{e, \mu, \tau} + e^- \rightarrow  \nu_{e, \mu, \tau} + e^-
  \quad\text{(ES)}
\end{align*}
is amenable to the inelastic scattering reaction, mediated by neutral current
\begin{align*}
  \nu_{e, \mu, \tau} + d \rightarrow  \nu_{e, \mu, \tau} + p + n
  \quad\text{(NC)}
\end{align*}
with a threshold of 2.2~MeV. In this case we have a neutron in the final state, that
can be detected directly or via neutron capture by either the deuton itself (followed
by the emission of a characteristic $\gamma$ ray of 6.25~MeV) or by some some additive
(e.g., NaCl, with the emission of a $\gamma$ of 8.6~MeV).

The Sudbury Neutrino Observatory (SNO), located 2100~m underground in Ontario, Canada,
was designed and operated between 1999 and 2006 with the precise intent of settling once
and for all the solar neutrino problem. The detector target was similar in spirit,
and technology, to SK, but the vessel was filled with heavy water---a form of water
whose hydrogen atoms are in fact both deuterium\sidenote{Procuring 1~kton of heavy
water is not a trivial undertake, and this one one of the difficulties connected
with the deployment of the experiment.}. For the CC and ES channel is the electron
in the final state being detected through its \cherenkov\ radiation, just like in
SK. For the (chiefly interesting) NC channel, the gamma ray in the final state can
Compton scatter off an atomic electron, with the latter having enough energy to trigger
the detector\sidenote{We note, though, that since the $\gamma$ is emitted isotropically,
the Compton electron bears no memory of the incoming direction of the neutrino, and
the same holds for the electron in CC channel. The only channel with directional
capabilities is the elastic scattering pioneered by SK.}

The SNO results~\cite{2004PhRvL..92r1301A} constitute the first contemporaneous
measurements of the solar $\nu_e$ flux (through the CC) and the \emph{total} neutrino
flux (through the NC) above an effective threshold of $\sim 5.5$~MeV, yielding
\begin{align*}
  \frac{\Phi_\text{CC}}{\Phi_\text{NC}} = 0.306 \pm 0.026~\text{(stat)} \pm 0.024~\text{(syst)}
\end{align*}
which is in agreement with the findings by the Homestake experiment. Most importantly,
a detailed analysis of all the available solar neutrino data showed that the SSM
could be reconciled with all the available information, providing that neutrino
oscillate and that the MSW mechanism is at play, the global best fits for the relevant
parameters being
\begin{align}
  \Delta m^2_\odot \approx 7.1 \times 10^{-5}~\text{eV}^2
  \quad\text{and}\quad
  \theta_\odot \approx 32.5^\circ
\end{align}

\todo{Include a combined plot of the electron survival probability, with a compilation
of different measurements. The one from Borexino Nature (2018) is a good starting
point.}

More recent measurements include those by Borexino, but it is fair to say that, by
the beginning of the years 2000s, the solar neutrino problem was solved and the
very basic facts that neutrino have mass and oscillate accepted. In the next section
we shall briefly present some more direct and complementary evidence obtained using
neutrinos produced by nuclear reactors.


\subsection{Verification with reactor neutrinos}

Reactor experiments typically consists of tanks of liquid scintillator read out by
photomultipliers and are designed to detect $\overline{\nu_e}$ (with a few MeV energy
on average) through the reaction
\begin{align*}
  \overline{\nu_e} + p \rightarrow e^+ + n
\end{align*}
whose signature is a prompt signal from the electrons and a delayed signal from
the gammas emitted when the neutron is captured after its termalization.

At a distance of $\sim 1$~km from the reactor, given the value of $\Delta m^2$ from
the solar neutrino experiments, the typical oscillation is $\sim 10^{-2}$, meaning
that near experiments are not sensitive to the mixing parameters between $\nu_1$
and $\nu_2$.  Much further from the reactor (say hundreds of km) the oscillation phase
at the MeV energy becomes $O(1)$ and experiments are sensitive to the $\nu_1\nu_2$
oscillation parameters. In fact Kamland observations~\cite{2005PhRvL..94h1801A} provide
further support to the LMA solution and, combined with the solar neutrino experiments,
allow to improve the accuracy of the measurement of $\theta_{12}$ and $\Delta m^2_{12}$.
\todo{Consider adding a plot from Kamland.}


\section{Atmospheric neutrinos}

We have already covered the reactions taking place in the atmosphere when hit from
primary cosmic rays, the dominant part of the decay chain involving neutrinos being
\begin{align*}
  \pi^+ \rightarrow \mu^+ + \bar{\nu}_\mu
  \quad\text{and}\quad
  \mu^+ \rightarrow e^+ + \nu_e + \bar{\nu}_\mu,
\end{align*}
along with the charge coniugates. At moderate energies, where the pions and the
muons have a small $\gamma$ factor and therefore tend to decay relatively quickly,
we have two muon neutrinos (or anti-neutrinos) for each electron neutrino (or anti-neutrino)
and one expects\sidenote{This is actually more accurately verified by detailed
Monte Carlo simulations than one would expect from a back-of-the envelope calculation.
In real life the key metrics is the double ration $R_\text{data} / R_\text{sim}$
where a number of systematic effects cancel out.}
\begin{align*}
  R = \frac{\nu_\mu + \bar{\nu}_\mu}{\nu_e + \bar{\nu}_e} \approx 2.
\end{align*}

\begin{marginfigure}
  \input{figures/atmospheric_nu_sketch.pgf}
  \caption{Sketch of an underground neutrino detector (not to scale). The Dashed
  line represents the average altitude where neutrinos are created within the
  Earth atmosphere.}
  \label{fig:atmospheric_nu_sketch}
\end{marginfigure}

Now, there are two notable differences between the solar and atmospheric neutrinos,
beside the fact that in the first case we start with 100\% $\nu_e$, while in the latter
we start with a mixture of $\nu_e$ and $\nu_\mu$: the energy is now significantly
larger (we area dealing with a continuous spectrum peaking at the GeV scale), and
the distances traveled by the neutrino from the creation to the detection site are
much shorter. Atmospheric neutrinos are created in the high atmosphere and, since
a typical detector has nearly full ($4\pi$) coverage, the actual path length depends
on the arrival direction with respect to the local zenith angle and can vary from
$\sim 10$~km (for neutrinos arriving from above) to more than $10,000$~km (for neutrinos
arriving from below and traversing the Earth), in any case much less than the A.~U.
that separates the Earth from the Sun. We should also note the the overall dynamics
in terms of path length, here, is about three orders of magnitude, which is also
much larger than the equivalent for Solar neutrinos.

\begin{marginfigure}
  \input{figures/atmospheric_nu_path.pgf}
  \caption{Distance traverse by atmospheric neutrinos between the creation and
  the detection site as a function of the cosine director with respect to the local
  zenith. The plot assumes an average altitude $h = 15$~km for the
  neutrino creation and a detector $2.5$~km undergrund.}
  \label{fig:atmospheric_nu_sketch}
\end{marginfigure}

If we plug the $\Delta m^2$ found for solar neutrino into the oscillation formula,
we get a typical phase $\varphi \approx 0.1$ for $E = 1$~GeV and $L = 1,000$~km,
that is, electron neutrinos hardly have room to oscillate to different flavors.
The fact that the neutrino energies are so much higher, though, opens the possibility
of creating muons in the final state, and deep-underground water-\cherenkov~experiments
such as SK can measure the flux ratio between $\nu_\mu$ and $\nu_e$ via CC interactions
on nuclei
\begin{align*}
  \nu_{e,~\mu} + N \rightarrow e~,\mu + X
\end{align*}
identifying the lepton in the final state. This, in conjuction with the ability to
measure the neutrino energy and direction, opens the possibility of studying the
separate $\nu_e$ and $\nu_\mu$ fluxes, as well as their ratio, as a function of the
zenith angle---i.e., as a function of the distance $L$ traveled by the neutrino.

The main SK results are that, while $\nu_e$ measurements agree reasonably well with
expectations in absense of oscillations, we have a significant deficit of
$\nu_\mu$, amounting to some $5\sim 0\%$ and extending to all zenith angle at low
energy and to upward-going neutrinos above $\sim 1$~GeV. This basic findings can be
interpreted naturally as $\nu_\mu \rightarrow \nu_\tau$ oscillations with
\begin{align}
  \Delta m^2_\text{atm} \approx 3 \times 10^{-3}~\text{eV}^2
  \quad\text{and}\quad
  \theta_\text{atm} \approx 45~^\circ.
\end{align}
More specifically, if we plug the numbers into the formula for the oscillation phase,
assuming an energy of 1~GeV, we have
\begin{align*}
  \varphi \approx \begin{cases}
  0.04 & \quad\text{for } L = 10~\text{km (upward-going)}\\
  50   & \quad\text{for } L = 13,000~\text{km (downward-going)}
\end{cases}
\end{align*}
that is, moving across different bins of zenith angles we explore all the possible
regimes, from the situation where the oscillation phase is small $\varphi \ll 1$
and oscillations do not take place, to that where the phase is large $\varphi \gg 1$
and the oscillations terms averages out to the sine squared of the mixing angle,
that in this case appears to be maximal.


\subsection{Verification with accelerator neutrinos}


\section{Three-flavor neutrino oscillations}

Up to this point we have discussed all the measurements in terms of oscillations
for two generations of neutrino, ending up with two distinct sets of $\Delta m^2$
and mixing angles, while in fact we know that three neutrino flavor exists, related
to the mass eigenstates by a $3 \times 3$ unitary matrix\sidenote{
This means that $U U^\dag = I$ or, equivalently $U^\dag = U^{-1} = (U^*)^T$.
In other words
\begin{align*}
  \begin{pmatrix}\nu_1\\ \nu_2\\ \nu_2  \end{pmatrix} =
  \begin{pmatrix}
    U_{e1}^* & U_{\mu 1}^* & U_{\tau 1}^*\\
    U_{e2}^* & U_{\mu 2}^* & U_{\tau 2}^*\\
    U_{e3}^* & U_{\mu 3}^* & U_{\tau 3}^*\\
  \end{pmatrix}
  \begin{pmatrix}\nu_e\\ \nu_\mu\\ \nu_\tau  \end{pmatrix}.
\end{align*}
}
\begin{align*}
  \begin{pmatrix}\nu_e\\ \nu_\mu\\ \nu_\tau  \end{pmatrix} = U
  \begin{pmatrix}\nu_1\\ \nu_2\\ \nu_3 \end{pmatrix} =
  \begin{pmatrix}
    U_{e1} & U_{e2} & U_{e3}\\
    U_{\mu 1} & U_{\mu 2} & U_{\mu 3}\\
    U_{\tau 1} & U_{\tau 2} & U_{\tau 3}\\
  \end{pmatrix}
  \begin{pmatrix}\nu_1\\ \nu_2\\ \nu_3 \end{pmatrix},
\end{align*}
which is customarily called the Pontecorvo-Maki-Nakagawa-Sakata (PMNS) mixing matrix.
In this section we shall briefly review the formalism for three-flavor neutrino
mixing, and how that ties to all we have said so far.

A $3 \times 3$ unitary matrix can in general be parametrized with 6~numbers (three
angles and three phases). This is the case if the neutrinos are Majorana
particles\sidenote{We shall come back to this when discussion neutrinoless double
$\beta$ decay.} (that is, if neutrino and antineutrino corresponds to the same
physical state), while if neutrinos are ordinary Dirac spinors, two of the phases
can be reabsorbed into the physical states, and the mixing matrix, just like the
CMK matrix for quarks, can be written in terms of three angles ($\theta_{12}$,
$\theta_{13}$, and $\theta_{23}$) and a phase $\delta_\text{CP}$\sidenote{We shall not
insist on this, but if this phase is non trivial, it implier that the CP discrete
symmetry is not conserved in neutrino interaction, hence the name.}, the most popular
parametrization being
\begin{align}
  U =
  \overbrace{
  \begin{pmatrix}
    1 & 0 & 0\\
    0 & c_{23} & s_{23}\\
    0 & -s_{23} & c_23 \\
  \end{pmatrix}
  }^\text{atmospheric}
  \begin{pmatrix}
    c_{13} & 0 & s_{13} e^{-i\delta_\text{CP}}\\
    0 & 1 & 0\\
    -s_{13} e^{i\delta_\text{CP}} & 0 & c_13\\
  \end{pmatrix}
  \overbrace{
  \begin{pmatrix}
    c_{12} & s_{12} & 0\\
    -s_{12} & c_12 & 0\\
    0 & 0 & 1\\
  \end{pmatrix}
  }^\text{solar},
\end{align}
where we have introduced the shorthand notation $s_{ij} = \sin\theta_{ij}$ and
$c_{ij} = \cos\theta_{ij}$. It is instructive to work out the full matrix multiplication
and spell out the PMNS mixing matrix in its full form
\begin{align}
  U =
  \begin{pmatrix}
    c_{12}c_{13} & s_{12}c_{13} & s_{13} e^{-i\delta_\text{CP}}\\
    -s_{12}c_{23} -c_{12}s_{13}s_{23}e^{i\delta_\text{CP}} &
      c_{12}c_{23} - s_{12}s_{13}s_{23}e^{i\delta_\text{CP}} & c_{13}s_{23}\\
    s_{12}s_{23} - c_{12}s_{13}c_{23}e^{i\delta_\text{CP}} &
      -c_{12}s_{23} - s_{12}s_{13}c_{23}e^{i\delta_\text{CP}} & c_{13}c_{23}\\
  \end{pmatrix},
\end{align}
which gives an immediate idea of how the formulation is algebrically more complicated
in the three-generation case, compared to the two-generation one.

Several global analyses of all available neutrino data exist, a recent, representative
one~\cite{2020JHEP...09..178E} yielding\sidenote{We are deliberately glitching over
some subtle details, as the fit results are slightly different in normal and inverse
mass ordering, but the differences are hardly relevant in our case.}
\begin{align}
  \theta_{12} & = 33.41^{+0.75}_{-0.72}~^\circ \nonumber\\
  \theta_{23} & = 42.2^{+1.1}_{-0.9}~^\circ \nonumber\\
  \theta_{13} & = 8.58^{+0.11}_{-0.11}~^\circ \nonumber\\
  \delta_\text{CP} & = 232^{+36}_{-26}~^\circ \nonumber\\
  \Delta m^2_{21} & = 7.41^{+0.21}_{-0.20} \times 10^{-5}~\text{eV}^2 \nonumber\\
  \Delta m^2_{31} & = \pm 2.507^{+0.026}_{-0.027} \times 10^{-3}~\text{eV}^2
\end{align}
Note the CP-violating phase is compatible, within current experimental uncertainities,
with $\delta_\text{CP} = 180^\circ$, i.e. with no CP violation. And, since we are at it,
this particular configuration translates into full matrix whose modulus can be written as
\begin{align*}
  \abs{U} =
  \begin{pmatrix}
    0.825 & 0.544 & 0.149\\
    0.362 & 0.654 & 0.664\\
    0.433 & 0.525 & 0.733\\
  \end{pmatrix}
  \quad\text{and}\quad
  \abs{U}^2 =
  \begin{pmatrix}
    0.681 & 0.296 & 0.022\\
    0.131 & 0.427 & 0.441\\
    0.187 & 0.276 & 0.537\\
  \end{pmatrix}
\end{align*}
which makes it immediately obvious how different is the mixing in the neutrino
sector with respect to the quark sector\sidenote{We note as a historical curiosity that
the \emph{bi-tri-maximal mixing}, where $\tan^2{\theta_{12}} = \nicefrac{1}{2}$
(or $\theta_{12} = 35.26^\circ$), $\theta_{23} = 45^\circ$ and $\theta_{13} = 0$
has been compatible with all experimental data for some time, and a very popular
choice, leading to the surprisingly simple (and elegant) form of the mixing matrix
\begin{align*}
  \abs{U}^2 =
  \begin{pmatrix}
    \nicefrac{2}{3} & \nicefrac{1}{3} & 0\\
    \nicefrac{1}{6} & \nicefrac{1}{3} & \nicefrac{1}{2}\\
    \nicefrac{1}{6} & \nicefrac{1}{3} & \nicefrac{1}{2}\\
  \end{pmatrix}.
\end{align*}
This is now definitely ruled out by the most recent measurements, but it is still
found in recent literature.}.
The explicit form of the modulus of the PMNS matrix is useful, as it allows to grasp
immediately the flavor content of the neutrino mass eigenstate, i.e.,
\begin{align}
  \abs{\braket{\nu_e}{\nu_1}}^2 = U_{e1}U^*_{e1} = \abs{U_{e1}}^2,
\end{align}
and so on and so forth. By taking the squares of the numerical values of the first
(second, third) column of the matrix, we get the $\nu_e$,  $\nu_\mu$ and $\nu_\tau$
content of the first (second, third) mass eigenstate: $\nu_1$ is prevalently $\nu_e$,
with non negligible contributions from $\nu_\mu$ and $\nu_\tau$, $\nu_2$ has roughly
equal contents of the three flavors, and $\nu_3$ is largely dominated by $\nu_\mu$
and $\nu_\tau$, with a fairly small $\nu_e$ content.


\subsection{Neutrino masses and mass hyerarchy}

The neutrino mass hierarchy cannot be fully resolved with current data. We do have
relatively precise measurements of the absolute values of $\Delta m^2_{21}$ and
$\Delta m^2_{32}$, and for the former that fact that MSW effect is playing a fundamental
role for solar neutrino allows to break the degeneracy and in the direction $m_2 > m_1$.
The third $\Delta m^2$, i.e., $\Delta m^2_{31}$, in not independent from the other
two, as
\begin{align*}
  \Delta m^2_{31} = \Delta m^2_{21} + \Delta m^2_{32} \approx \Delta m^2_{32}.
\end{align*}
In other words, we know that $\nu_1$ and $\nu_2$ consitute a closely-spaced doublet,
a relatively small small difference, while $\nu_3$ is comparatively further away.

What we don't know for sure, yet, is whether  $m_3 > m_{1,2}$ or $m_3 < m_{1,2}$;
we refer to the first case as \emph{normal ordering} and to the second as
\emph{inverse ordering} and we do a theroretical prejudice to impute the largest
mass to $m_3$, wich has the largest $\tau$ content---but it is fair to remember that
in the old days another such prejudice existed for the PMNS matrix to be quasi-diagonal,
as in the case of the CKM matrix, and that did not work out well.
\todo{Consider adding the standard plot of neutrino masses.}

\begin{marginfigure}
  \input{figures/neutrino_mass_scale.pgf}
  \caption{Illustration of the behavior of the three neutrino masses, in normal and
  inverse ordering, as a function of $m_1$ (which is not yet well constrained by the
  experimental data).}
  \label{fig:neutrino_mass_scale}
\end{marginfigure}

In addition, we don't know the absolute scale of the masses, although we have several,
independent evidences, from both $\beta$ decay and cosmological metrics, that none
of the $m_i$ cannot be much larger than 1~eV. The implication is that, as summarized in
figure~\ref{fig:neutrino_mass_scale}, if $m_1$ is zero (or close to zero), then
$m_2 \approx 10$~meV and $m_3 \approx 50$~meV, assuming normal ordering. On the
other hand, if $m_1$ is larger than $\sim 100$~meV, then the three masses are more
or less all equal, in both normal and inverted ordering.


\subsection{Three flavor mixing}

Three-flavor neutrino mixing is significantly more complicated than the two-flavor
version from a purely algebraic point of view, although the basic derivation proceeds
exactly in the same way. We shall not work out the full calculation, here, but if we
forget for a second the CP violating phase (which data indicate might be trivial,
after all) the oscillation (or survival) probability between two flavors $\nu_\alpha$
and $\nu_\beta$ reads
\begin{align}
  P(\nu_\alpha \rightarrow \nu_\beta) = \delta_{\alpha\beta} -
  4\sum_{i=1}^{3}\sum_{j < 1} U_{\alpha i} U_{\beta i}U_{\alpha j} U_{\beta j}
  \sin^2\qty(\frac{\Delta m^2_{ij} L}{4\hbar c E})
\end{align}


Nature was kind enought, though, to help un in two ways: $\theta_{13}$ is
\emph{small} and $\Delta m^2_{21} \ll \Delta m^2_{31}$. As we shall see in a second,
this allows for significant simplifications in relevant setups.

Let us start by examining the phases
\begin{align*}
  \phi_{ij} = \frac{\Delta m^2_{ij} L}{4 \hbar c E} =
  1.27\, \frac{\Delta m^2_{ij}~[\text{eV}^2]~L~[\text{m}]}{E~[\text{MeV}]}.
\end{align*}
For solar neutrinos $\nicefrac{L}{E}$ is very large compared to all $\Delta m^2$,
and the trigonometric terms averages out quickly---starting from the highest mass
differences. In this case we have, only keeping the phase corresponding to the
smallest mass difference
\begin{align*}
  P(\nu_e \rightarrow \nu_{\mu,~\tau}) =
  \cos^2(\theta_{13})\sin^2(2\theta_{12})\sin^2\qty(\frac{\Delta m^2_{21} L}{4\hbar c E}) +
  \frac{1}{2}\sin^2(2\theta_{13}),
\end{align*}
that, in the limit of small $\theta_{13}$ becomes
\begin{align*}
  P(\nu_e \rightarrow \nu_{\mu,~\tau}) \approx
  \sin^2(2\theta_{12})\sin^2\qty(\frac{\Delta m^2_{21} L}{4\hbar c E}).
\end{align*}
This is exactly the result we have derived early in the two-generation scheme---only
now we have explicitly named the $\Delta m^2$ and mixing angle involved.

For atmoshperic neutrinos the situation is different, as $\nicefrac{L}{E}$ is
small compared to $\Delta m^2_{12}$, but not with respect $\Delta m^2_{23}$ and
$\Delta m^2_{13}$, and the relevant oscillation probabilities read
\begin{align*}
  P(\nu_\mu \rightarrow \nu_\tau) & =
  \cos^2(\theta_{13})\sin^2(2\theta_{23})\sin^2\qty(\frac{\Delta m^2_{32} L}{4\hbar c E})
  \rightarrow \sin^2(2\theta_{23})\sin^2\qty(\frac{\Delta m^2_{32} L}{4\hbar c E})\\
  P(\nu_e \rightarrow \nu_\mu) & =
  \sin^2(\theta_{13})\sin^2(2\theta_{23})\sin^2\qty(\frac{\Delta m^2_{32} L}{4\hbar c E})
  \rightarrow 0\\
  P(\nu_e \rightarrow \nu_\tau) & =
  \sin^2(\theta_{13})\cos^2(2\theta_{23})\sin^2\qty(\frac{\Delta m^2_{32} L}{4\hbar c E})
  \rightarrow 0.
\end{align*}
Nowadays all the analyses are properly done with a three-flavor mixing framework,
but we have learned that, due to the particular combinations of mixing parameter
values, both solar and atmospheric neutrino oscillations can \emph{approximately}
be interpreted in a two-flavor mixing scenario, the former being sensitive to
$\theta_{12}$ and $\Delta m^2_{21}$, and the latter to $\theta_{32}$ and $\Delta m^2_{32}$.
This is the very reason for the particular decomposition of the PMNS matrix, as
well as the naming of the different terms.


\section{Cosmic neutrinos}


\subsection{Neutrinos from Supernov\ae}


\section{State of the art and outlook}

% https://physics.stackexchange.com/questions/341904/how-is-delta-m2-12-is-identified-with-the-solar-mixing-angle
% https://www.worldscientific.com/doi/pdf/10.1142/9789811269776_0225



\subsection{Current open problems}
